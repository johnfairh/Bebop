# Options

* [Syntax](#syntax) - how options work
* [Gather](#gather) - getting information about declarations
* [Content](#content) - what goes into the docs
* [Style](#style--chrome) - how docs are displayed
* [Docsets](#docsets) - configure Dash docset generation
* [Meta](#meta) - how the program runs

## Syntax

If an option is described as `--option-name` then it is a boolean flag and does
not have an associated value.  Its config key is `option_name` meaning you can
write `option_name: yes` (or `true` or `on`).  You can write `--no-option-name`
to invert the flag.

If an option is described as `--option-name VALUE` then it requires a single
value.  You can write `--option-name=VALUE`.  In the config file you can write
`option_name: value` or as a single-item sequence `option_name: [value]`.

If an option is described as `--option-name VALUE` and documented as supporting
localization through the config file then it can be given different values for
each localization by writing a map in the config file, using the language tag
of each localization as the key.

If an option is described as `--option-name VALUE,...` then it requires 1+
values.  You can write `--option-name V1,V2,V3` using a backslash to escape an
actual comma, or repeat the option `--option-name V1 --option-name V2,V3`.  In
the config file you can write `option_name: V1` or a sequence.

CLI options don't have to be written in full, just enough to make the meaning
unambiguous.  In config files you need to write out the whole thing.

## Control

`--products` controls what the tool creates.  Lets you skip creation of parts
you don't need or generate structured json data describing various phases of
docs generation.  This can be used for ingestion elsewhere or as input to
another invocation of the program running on a different operating system, for
example.

* `file-json` prints file-oriented json describing the code definitions to be
documented.
* `decls-json` prints definition-oriented json describing the code definitions
to be documented, merging duplicates and extensions together.
* `docs-summary-json` prints page-oriented json describing the docs to be
generated including a table of contents and guide HTML.
* `docs-json` prints long-winded json describing each page to be created,
including everything that is passed to the templating engine for the `docs`
pass.
* `docs` generates html/markdown documentation according to a theme in an
output directory.
* `docset` generates a [Dash](https://kapeli.com/dash) docset version of the
html docs in the `docsets` subdirectory of the output directory.  See
[Docsets](#docsets) below for more.
* `stats-json` generates a report about various types of event in the program,
by default in the docs directory.
* `undocumented-json` generates a report about undocumented definitions, by
default in the docs directory.
* `theme` is different: it can't be set alongside any others, and copies the
selected theme's raw files into the output directory.  Use this to get a copy
of the theme to start customizing it.

## Gather
Two modes of operation, simple and custom.  _Simple_ is for one module (or
multiple modules in the same language & directory & compiler flags, such as
an app and its extensions). _Custom_ is for multiple modules built in multiple
ways in multiple locations -- configured only in the config file.

### Simple - Swift Source Project
* `--build-tool spm|xcodebuild` tool to build the module.  Guessed if omitted.
* `--build-tool-arguments` any extra flags to pass to the build tool.
* `--modules` names of modules to build.  Guessed if omitted.
* `--source-directory PATH` where to build from.  Current dir if omitted.

### Simple - Objective-C
* `--objc-direct` use Jazzy's approach to building the header file, straight
  to clang with user-supplied/guessed compiler flags.
* `--objc-header-file` root header file to compile and document.
* `--objc-include-paths` list of directories to add as `-I` compiler flags.
  Also includes directories beneath these places that lead to header fils.  Only
  for `--objc-direct` mode.
* `--sdk` set the SDK.  Defaults to macOS.
* `--build-tool-arguments` in `--objc-direct` mode sort of mimics Jazzy - if
  they start with "-x objective-c" then assume this is a Jazzy config port and
  just pass all those args to clang instead of any of our own.  Otherwise they
  are used as _additional_ flags to clang on top of the stuff generated by
  default and modified by `--objc-include-paths` and `--objc-sdk`.
* `--modules` sets the name of the module.

### Simple - Swift SymbolGraph
Use the `swift symbolgraph` tool to build docs directly from a .swiftmodule
or a framework without rebuilding the package.

* `--build-tool swift-symbolgraph` enable the mode.
* `--modules` set the module name.  Mandatory.
* `--symbolgraph-target` set the target triple for the module.
  Defaults to the current host target.
* `--symbolgraph-searchpaths` add directories to search for `.swiftmodule` or
  `.framework`s.
* `--sdk` set the SDK.  Defaults to macOS.
* `--build-tool-arguments` to customize the arguments to `swift symbolgraph`.
  If a pass-through argument is set here such as `--sdk=` then it overrides
  any _bebop_ `--sdk`.

[More about SymbolGraph support](symbolgraph.md).

### Simple - Swift CocoaPods
This builds all the targets mentioned in a podspec and merges them together.
* `--podspec` gives the `.podspec` file to use.
* `--pod-sources` adds private pod sources for finding dependencies, same
  as doing `source` in `Podfile`s.

### Custom
Instead of using `--modules` you can write `custom_modules` in the config file.
This introduces a two-level hierarchy that can express multiple passes over
multiple modules.  All of the simple options mentioned above can be set at any
level, including the root via config file or CLI, and cascade down the tree.

Examples:
```yaml
custom_modules:
  - module: MyAppModule
  - module: MyNotificationExtension
```
```yaml
custom_modules:
  - module: SwiftModule
    build_tool: spm
  - module: ObjCModule
    objc_header_file: ObjCModule/include/ObjCModule.h
```
```yaml
custom_modules:
  - module: Module1
    ignore_availability_attr: true
    passes:
      - default_availability: Normal
      - build_tool_arguments: -DDEBUG
        default_availability: Debug
  - module: Module2
    source_directory: M2/Spm
```

### All -- Simple, Custom, Swift, ObjC

* `--doc-comment-language` language tag for the language doc comments are
  written in.  If unset assumed to be consistent with default localization.
* `--doc-comment-languages-directory` directory containing language-tag subdirs
  with `QuickHelp.strings` files to localize doc comments.  See
  [localization](localizations.md).
* `--availability-defaults` any default content for the "Availability" boxes
  for each definition in the module.
* `--ignore-availability-attr` do not add anything from Swift `@available`
  attributes to the "Availiability" boxes.  Use in conjuction with
  `--availability-defaults` to completely control that content.
* `--merge-modules` displays eg. types from all modules in one group, rather
  than creating one group per kind per module.
* `merge_module_group` (YAML-only) extension to `--merge-modules` to set up
  multiple multi-module groups and name the groups.  Localizable.
* `--sourcekitten-json-files` use instead of the actual build options to use
  data from running `sourcekitten`.  Slightly poorer quality output than
  running against the source files.
* `--bebop-json-files` use to build docs from `--products files-json` output
  from a previous run of the program.  Filters the imported file based on
  any module or pass options / config position.

## Content
* `--min-acl` what ACLs of Swift definition to include in the docs.
* `--readme` is a markdown file for the index.  Searches for a
 `README.md`-like file by default. Localizable.
* `--guides` wildcard paths for guides, markdown files to
  include in the docs.  Localizable.
* `guide_titles` config key to [localize guide titles](localizations.md).
* `--skip-undocumented` omit defs without any documentation.
* `--skip-undocumented-override` omit defs without any doc comments _iff_ they
  are overriding defs from parent classes or protocols.
* `--undocumented-text` if not being skipped, markdown for undocumented defs.
  Localizable.
* `--include-source-files` filename-glob filtering, include only defs from
  matching files.
* `--exclude-source-files` filename-glob filtering, omit defs from matching
  files.  Applied to the result of `--include-source-files`.
* `--exclude-names` regexps of doc names to exclude.
* `--ignore-inherited-docs` never use inherited docs to backfill defs that
  don't have doc comments of their own.  [More on inherited docs](misc.md).
* `--custom-abstracts` wildcard paths for markdown to prepend to group or
  definition pages.  Localizable.
* `--custom-abstract-overwrite` replace existing doc comments instead of
  prepending.
* `custom_groups` controls layout of the site.  See [below](#custom-groups).
* `custom_groups_unlisted_prefix` tweaks headings for items not picked up by
  `custom_groups`.
* `--exclude-unlisted-guides` controls visibility of guides not picked up by
  `custom_groups`.
* `custom_defs` controls layout of individual type pages.  See
  [below](#custom-defs).
* `--apple-autolink` is on by default and enables autolinking of identifers
  like `String` or `UIWindow` to the online Apple docs.
* `--apple-autolink-xcode-path` changes the Xcode to use for looking up
  identifiers.
* `remote_autolink` configure other Jazzy/Bebop doc sites to autolink identifiers.
  Array of such sites, each with keys:
    * `url` URL of the doc root, ie. the directory containing `index.html`.
    * `modules` list of modules covered by the remote site.  Mandatory for
      remote Jazzy docs, optional for remote Bebop docs.
* `group-style` controls how things are grouped outside of custom groups.
  Default is by kind (types together) can set `path` to generate mixed
  groups corresponding to filesystem directory structure.

### Custom Groups

Example showing localized title, optional abstract, optional topic structure,
regexp children, nested groups:
```markdown
custom_groups:
  - name:
      en: Fish
      fr: Poissons
    abstract: Here are the available fish.
    topics:
      - name: Freshwater
        children:
          - /(Rainbow )?Trout/
          - Perch
      - name: Saltwater
        abstract: Various ocean fish.
        children:
          - Herring
          - Cod
  - name: Rods
    children:
      - name: Short
        children:
          - Brown
          - Black
      - name: Long
        children:
          - Red
          - Blue
      - Pretend
```

Bebop normally separates Swift and Objective-C views.  Custom groups
work differently, for example if you list a Swift-only type then
it will appear in both language views.  You can turn this off by
writing `mix_languages: no` as part of the group stanza.

### Custom Defs

Example showing localized topic names, abstracts, ways of referring to
items:
```markdown
custom_defs:
  - name: MyClass.Nested
    skip_unlisted: true
    topics:
      - name: Topic1
        children:
          - aField
          - var anotherField: Int
      - name: Topic2
        abstract: Extra fields for `Encodable` support.
          - thirdField where T: Encodable
  - name: MyModule.MyOtherClass
    topics:
      - name: Topic
        children:
           - someMethod(param:)
  - name: MyThirdClass
    topics:
      - name: Important Members
        children:
           - a(b:)
           - struct Fred

```

## Style + Chrome
* `--output PATH` directory in which to put docs.
* `--output-stats PATH` file to produce stats report.
* `--output-undocumented PATH` file to produce undocumented defs report.
* `--clean` delete output directory and contents before starting.
* `--theme name|PATH` theme name or custom path.  Bebop comes with two themes,
  'fw2020' for html and 'md' for markdown.  Themes must contain a `templates`
  directory and must contain a `theme.yaml` file to be treated as a Bebop theme
  rather than a legacy Jazzy theme - [details](misc.md).
* `--default-localization LOCSPEC` default localization.  A `LOCSPEC` looks like
  `tag:flag:label`, eg. `en:🇺🇸:English`.  The tag is used to find resources
  during generation the other parts in the generated docs' UI.
* `--localizations LOCSPEC,...` other localizations to support in addition to
  the default localization.
* `--hide-search` omits the searchbar from the UI and does not generate a
  JSON search index.
* `--hide-attribution` omits the attribution line from the UI.
* `--hide-coverage` omits the "23% documented" line from the UI.
* `--hide-availability` omits the "Availability" boxouts from all pages.
* `--hide-pagination` omits the prev/next navigation at the bottom of pages.
* `--custom-head HTML` lets you add HTML into the `head` element of each page.
* `--title TITLE` sets the title at the top of each page.  Localizable.
* `--breadcrumbs-root TITLE` set the text for the left-most breadcrumb on each
  page.  Localizable.
* `--module-version VERSION` contributes to the auto-generated title at the top
  of each page in the case that `--title` is not set.
* `--custom-copyright MARKDOWN` sets the copyright line in the footer.
  Localizable.
* `--author-name NAME` sets the author name used in the generated copyright or
  readme.  Localizable.
* `--author-url URL` sets the author URL used in the genereated copyright.
* `--child-item-style` changes how child definitions are displayed.
    * `nested` is like Jazzy: children always nested inside parents; if a def has
      no children then it doesn't get a page of its own.
    * `separate` is like Apple: all definitions get a page of their own, the
      only content on the parent page is its name and any brief abstract.
    * `nested-separate-types` is like `nested` except nominal types always get a
      page of their own, even if they have no children.
* `--nested-item-style` changes how nested child definitions are displayed.
    * `start-closed` means the collapse feature is enabled and everything
      starts out collapsed.
    * `start-open` means the collapse feature is enabled but everything starts
      out open (uncollapsed).
    * `always-open` means the collapse feature is disabled: everything is
      always open and there's no way to collapse them.
* `--default-language` says whether Objective-C or Swift is the default view,
  for docs that contain both languages.
* `--media` globs of image etc. files to ship in the docs, link to using the
  base filename in markdown links/images.
* `--rewrite-link-urls` prefix for absolute (http://) links to replace with
  internal links to files with the same name in guides/media.  For when you
  deploy the source md docs independently or have links in quick help.
* `custom_brand` options to customize the 'brand' area in the top left of every
  page.  Subkeys:
  * `image_name` name of an image from `--media`, will be 30x30 in the site.
  * `url` link for the image and title.  Localizable.
  * `alt_text` alt-text for the image.  Localizable.
  * `title` 'title' attribute for the image.  Localizable.
* `--code-host` picks GitHub/GitLab/BitBucket links, or use `custom_code_host`
  for something else.
* `--code-host-url` sets the URL, per-module, to link to from the code host
  icon in the page header.  Localizable.
* `--code-host-file-url` sets the URL prefix to construct file links to from
  each item with filename/line numbers.  Can be set per module.  Used in
  conjunction with `--source-directory` to compute relative paths.
* `custom_code_host` options to configure the code-host header space and the
  deep links.  Subkeys:
  * `image_name` name of the image from `--media`, will be 22x22 in the site.
  * `alt_text` alt-text for the image.  Localizable.
  * `title` 'title' attribute for the image.  Localizable.
  * `single_line_format` format for URL fragment for single-line links.  No #.
     Use '%LINE' in place of the line number.  Defaults to GitHub format.
  * `multi_line_format` same for line-range links.  Use '%LINE1' and '%LINE2'.
  * `item_menu_text` replace the 'Open on GitHub' label.  Localizable.
* `--hide-language` omits the version of declarations in Swift or ObjC.

## Docsets

The docset is for the main localization only.

The main artifact is the docs/docsets/<ModuleName>.docset folder.  This can
be directly loaded into Dash.  Options to enhance the Dash integration:
* `--docset-module-name` sets a custom name for the docset.
* `--docset-playground-url` associates a playground URL with the docset,
  available in the Dash UI to try out your framework via some online means.
* `--docset-icon`, `--docset-icon-2x` set .png icons for the docset.
* `--deployment-url` the web URL where you will host the docs.  Lets the
  Dash UI link there from its offline copy.  A value for `--docset-feed-url` is
  inferred if you do not also set that.
* `--docset-feed-url` the web URL of the Dash feed XML file.  This option makes
  the Dash logo appear in the heading of the docs and clicking it will open
  the docset in Dash.

This docset feed business and all the URLs can be confusing.  Here is the
simplest way to set everything up.
1. Figure out where you will host the docs, say
   `https://johnfairh.github.io/Sample/docs`.
2. Create the docs with the miniumum of these options:
   ```shell
   bebop --deployment-url https://johnfairh.github.io/Sample/docs
         --module-version 1.0
   ```
3. Check the `docs/docsets` directory has three things in it: the `.docset`
   subdirectory, a tarfile, and an xml file.
4. Upload everything in the docs directory including the `docsets` subdirectory.

The XML feed file points back to the deployment URL that is hosting the tgz,
which is the thing that gets downloaded and installed in Dash when the user
clicks on the Dash logo in your docs.

You can host the XML file in a separate location if you want, use
`--docset-feed-url`.

## Meta
* `--config PATH` config file location.
* `--debug` debug mode.  Extra tracing with timestamps, all to stderr.
* `--help` show help and exit.
* `--help-aliases` show list of option aliases and exit.
* `--quiet` quiet mode.  Print only fatal errors.
* `--version` show version and exit.
